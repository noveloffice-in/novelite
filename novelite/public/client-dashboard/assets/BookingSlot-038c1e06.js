import{c as G,_ as D,b as F,r as x,u as Q,a as q,j as i,y as R,x as ie,ah as le,a7 as ce,a2 as de,al as pe,am as ue}from"./index-7beedb8e.js";import{P as ge}from"./PageContainer-beff9693.js";import{B as me}from"./Breadcrumb-f0f04833.js";import{C as H}from"./ChildCard-4ac1dd10.js";import{u as fe,G as be}from"./Grid-e0639067.js";import{B as ye}from"./Box-b5a46f12.js";import{a as K,g as X,s as Z,B as he,c as E,b as ee,T as V}from"./Typography-212872cb.js";import{k as xe,Q as ve}from"./ReactToastify-303f0f3e.js";import{F as Se,I as Ce,S as ke}from"./Select-f2445807.js";import{M as Te}from"./MenuItem-958df465.js";import{b as Be}from"./Button-d219dec2.js";import{S as $e}from"./Stack-3d887df5.js";import{u as Re}from"./useDispatch-a9326f5b.js";import"./index.esm-d9ef1124.js";import"./Box-d98c1a64.js";import"./Card-e685ffd3.js";import"./CardHeader-461005f7.js";import"./Divider-db5e0b6a.js";import"./CardContent-ee48826d.js";import"./ListContext-9e5014b9.js";import"./useFormControl-77288aaf.js";import"./useControlled-92ccd080.js";import"./Modal-9dacc2fa.js";import"./listItemTextClasses-a15652ad.js";import"./createStack-0ca957c9.js";import"./styled-fbde418f.js";function De(e){return X("MuiToggleButton",e)}const Me=K("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),Y=Me,_e=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],je=e=>{const{classes:o,fullWidth:r,selected:a,disabled:c,size:m,color:v}=e,f={root:["root",a&&"selected",c&&"disabled",r&&"fullWidth",`size${G(m)}`,v]};return ee(f,De,o)},Ne=Z(he,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[`size${G(r.size)}`]]}})(({theme:e,ownerState:o})=>{let r=o.color==="standard"?e.palette.text.primary:e.palette[o.color].main,a;return e.vars&&(r=o.color==="standard"?e.vars.palette.text.primary:e.vars.palette[o.color].main,a=o.color==="standard"?e.vars.palette.text.primaryChannel:e.vars.palette[o.color].mainChannel),D({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},o.fullWidth&&{width:"100%"},{[`&.${Y.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:F(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.selected}`]:{color:r,backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:F(r,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${a} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:F(r,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:F(r,e.palette.action.selectedOpacity)}}}},o.size==="small"&&{padding:7,fontSize:e.typography.pxToRem(13)},o.size==="large"&&{padding:15,fontSize:e.typography.pxToRem(15)})}),ze=x.forwardRef(function(o,r){const a=Q({props:o,name:"MuiToggleButton"}),{children:c,className:m,color:v="standard",disabled:f=!1,disableFocusRipple:y=!1,fullWidth:l=!1,onChange:s,onClick:d,selected:k,size:p="medium",value:B}=a,$=q(a,_e),S=D({},a,{color:v,disabled:f,disableFocusRipple:y,fullWidth:l,size:p}),M=je(S),I=n=>{d&&(d(n,B),n.defaultPrevented)||s&&s(n,B)};return i.jsx(Ne,D({className:E(M.root,m),disabled:f,focusRipple:!y,ref:r,onClick:I,onChange:s,value:B,ownerState:S,"aria-pressed":k},$,{children:c}))}),Oe=ze;function We(e,o){return o===void 0||e===void 0?!1:Array.isArray(o)?o.indexOf(e)>=0:e===o}function Ie(e){return X("MuiToggleButtonGroup",e)}const we=K("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),C=we,Fe=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ge=e=>{const{classes:o,orientation:r,fullWidth:a,disabled:c}=e,m={root:["root",r==="vertical"&&"vertical",a&&"fullWidth"],grouped:["grouped",`grouped${G(r)}`,c&&"disabled"]};return ee(m,Ie,o)},Le=Z("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[{[`& .${C.grouped}`]:o.grouped},{[`& .${C.grouped}`]:o[`grouped${G(r.orientation)}`]},o.root,r.orientation==="vertical"&&o.vertical,r.fullWidth&&o.fullWidth]}})(({ownerState:e,theme:o})=>D({display:"inline-flex",borderRadius:(o.vars||o).shape.borderRadius},e.orientation==="vertical"&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${C.grouped}`]:D({},e.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderTop:0,marginTop:0}})})),Pe=x.forwardRef(function(o,r){const a=Q({props:o,name:"MuiToggleButtonGroup"}),{children:c,className:m,color:v="standard",disabled:f=!1,exclusive:y=!1,fullWidth:l=!1,onChange:s,orientation:d="horizontal",size:k="medium",value:p}=a,B=q(a,Fe),$=D({},a,{disabled:f,fullWidth:l,orientation:d,size:k}),S=Ge($),M=(n,T)=>{if(!s)return;const w=p&&p.indexOf(T);let _;p&&w>=0?(_=p.slice(),_.splice(w,1)):_=p?p.concat(T):[T],s(n,_)},I=(n,T)=>{s&&s(n,p===T?null:T)};return i.jsx(Le,D({role:"group",className:E(S.root,m),ref:r,ownerState:$},B,{children:x.Children.map(c,n=>x.isValidElement(n)?x.cloneElement(n,{className:E(S.grouped,n.props.className),onChange:y?I:M,selected:n.props.selected===void 0?We(n.props.value,p):n.props.selected,size:n.props.size||k,fullWidth:l,color:n.props.color||v,disabled:n.props.disabled||f}):null)}))}),Ee=Pe;function Ue({slotsData:e,selectedSlots:o,setSelectedSlots:r,intervals:a}){const c=fe(),m=l=>{const[s,d]=l.split(":").map(Number);return s*60+d},v=l=>l.sort((s,d)=>{const k=m(s.split(" - ")[0]),p=m(d.split(" - ")[0]);return k-p}),f=l=>{let s=[];return e==null||e.forEach(d=>{s=s.concat(d.booking_timings.split(","))}),s==null?void 0:s.some(d=>d===l)},y=(l,s)=>{const d=v(s);console.log(d),r(d)};return i.jsx(ye,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",md:"repeat(8, 1fr)",ls:"repeat(9, 1fr)"},gap:"16px"},children:(a==null?void 0:a.length)!==0&&a.map((l,s)=>i.jsx(Ee,{value:o,onChange:y,"aria-label":"text formatting",children:i.jsxs(Oe,{value:l,disabled:f(l),variant:"contained",sx:{width:"100%",border:(c.palette.mode==="dark","1px solid grey"),color:c.palette.mode==="dark"?"white":"black","&.Mui-selected":{backgroundColor:c.palette.mode==="dark"?"#154c79":"#5462D6",color:"white",boxShadow:c.palette.mode==="dark"?"2px 2px 2px black":"2px 2px 2px grey"},"&.Mui-disabled":{backgroundColor:"rgba(0, 0, 0, 0.12)",color:(c.palette.mode==="dark","grey")}},children:[l.split("-")[0]," - ",l.split("-")[1]]},s)},l+s))})}function yt(){const[e,o]=x.useState(`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`),[r,a]=x.useState([]),[c,m]=x.useState([]),[v,f]=x.useState(""),y=R(t=>t.bookingsSliceReducer.roomName),l=R(t=>t.bookingsSliceReducer.roomCategory),s=R(t=>t.bookingsSliceReducer.bookingLocation),d=R(t=>t.novelprofileReducer.account_type),k=R(t=>t.novelprofileReducer.companyName),p=R(t=>t.novelprofileReducer.leadsID),B=ie(),$=Re();let S=30,M=7;const n=R(t=>t.bookingsSliceReducer.price)/2*r.length,T=n*(18/100),w=n+T;x.useEffect(()=>{const t=[],g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let N=0;N<M;N++){const b=new Date;b.setDate(b.getDate()+N);const z=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}`,u=`${String(b.getDate()).padStart(2,"0")}-${j[b.getMonth()]}`,h=g[b.getDay()];t.push({date:z,day:h,formattedDate:u})}m(t),f(t[0].day)},[M]);const _=t=>ve.warn(t,{toastId:"warn"}),te=[{to:"/dashboard",title:"Home"},{to:"/location",title:"Location"},{to:"/category",title:"Category"},{to:"/bookings",title:y},{to:"/bookingslot",title:"Booking Slots"}];let L="",O="",U=[];const{data:A,mutate:oe}=le("Room Bookings",{fields:["name","location","booking_timings","booking_date","room"],filters:[["booking_date","=",e],["room","=",y]],limit_start:0,limit:2e3}),{data:P}=ce("Room Booking Settings","Room Booking Settings");if(c.length!==0){let t=P==null?void 0:P.availability_of_slots.find(g=>g.day_of_week==v);L=t==null?void 0:t.from_time,O=t==null?void 0:t.to_time,O==="23:59:59"&&(O="24:00:00")}if(L!==void 0&&O!==void 0){const t=u=>{var J;const[h,W]=(J=u==null?void 0:u.split(":"))==null?void 0:J.map(Number);return h*60+W},g=u=>{const h=Math.floor(u/60),W=u%60;return`${String(h).padStart(2,"0")}:${String(W).padStart(2,"0")}`},j=t(L),b=t(O)-j,z=Math.floor(b/S);for(let u=0;u<z;u++){const h=j+u*S,W=h+S;U.push(`${g(h)} - ${g(W)}`)}}const re=t=>{a([]),o(t.date),f(t.day)},{createDoc:ae,isCompleted:Ae}=de(),se=()=>{let t=`${r}`,g=`${p}`,[j,N,b]=e.split("-"),z=`${j}-${N}-${b}`,u={booking_status:"Blocked Temporarily",location:s,room:y,price:w,room_type:l,customer:k,client_type:d,booking_date:z,customer_lead_id:g,booking_timings:t};r.length!==0?ae("Room Bookings",u).then(()=>{$(pe(r)),$(ue(z)),a([]),oe(),B("/payment_summary")}).catch(h=>{console.log("inside catch "+JSON.stringify(h.message))}):_("Please Select any slot to continue")};function ne(t){if(Number.isInteger(t)){let g=t.toString();return g.length>3?g.slice(0,-3)+","+g.slice(-3):g}else return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}return i.jsxs(ge,{title:"Book Slots - Novel Office",children:[i.jsx(me,{title:"Booking Slots",items:te}),i.jsxs(Se,{sx:{minWidth:130,mb:2,mr:4},children:[i.jsx(Ce,{id:"demo-simple-select-label",children:"Select Date"}),i.jsx(ke,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:e,label:"Select Date",children:c==null?void 0:c.map(t=>i.jsx(Te,{value:t.date,onClick:()=>re(t),children:t.formattedDate},t.date))})]}),A&&i.jsx(Ue,{slotsData:A,selectedSlots:r,setSelectedSlots:a,intervals:U}),i.jsxs(be,{item:!0,xs:12,lg:6,display:"flex",alignItems:"stretch",mt:2,children:[i.jsx(H,{title:"",children:i.jsx(Be,{variant:"contained",color:"primary",onClick:se,children:"Proceed"})}),i.jsx(H,{title:"",children:i.jsxs($e,{children:[i.jsxs(V,{variant:"h4",mb:.5,children:["Price : â‚¹ ",ne(n)]}),i.jsx(V,{variant:"h6",color:"primary",children:"(* GST not included)"})]})})]}),i.jsx(xe,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}export{yt as default};
